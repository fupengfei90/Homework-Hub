# ⏰ 待办提醒功能说明

## 功能概述

待办提醒功能帮助学生合理安排作业时间，通过设置提醒时间和目标完成时间，系统会自动计算建议的开始时间，并在指定时间提醒学生写作业。

## 核心功能

### 1. 提醒时间设置
- **每日提醒**：可以设置每天固定的提醒时间（如：每天早上8:00）
- **自动提醒**：到时间后会自动弹出提醒框
- **稍后提醒**：如果暂时不想写，可以点击"稍后提醒"，5分钟后再次提醒

### 2. 智能时间计算
- **目标时间设置**：设置目标完成时间（如：晚上10:30睡觉）
- **预估时间设置**：设置完成作业需要的时间（10-180分钟，可滑动调整）
- **自动计算**：系统会根据目标时间和预估时间，自动计算出建议的开始时间

### 3. 完成标记
- **标记完成**：完成作业后可以标记为已完成
- **自动清除**：标记完成后会自动清除提醒

## 使用流程

### 第一步：设置提醒
1. 在作业详情页，点击"设置提醒"按钮
2. 进入提醒设置页面

### 第二步：设置提醒时间
1. 点击"提醒时间"选择器
2. 选择每天提醒的时间（如：08:00）
3. 系统会自动保存并设置提醒

### 第三步：设置目标时间（可选）
1. 点击"目标完成时间"选择器
2. 选择目标完成时间（如：22:30睡觉）
3. 系统会自动计算建议开始时间

### 第四步：调整预估时间（可选）
1. 拖动滑块设置预估完成时间
2. 系统会实时计算并显示建议开始时间

### 第五步：完成作业
1. 完成作业后，点击"标记为已完成"
2. 系统会清除提醒并保存完成状态

## 功能示例

### 示例1：每日提醒
- **场景**：每天早上8点提醒写作业
- **设置**：
  - 提醒时间：08:00
- **效果**：每天8点会弹出提醒框："该写作业了！"

### 示例2：智能时间规划
- **场景**：要在10点半睡觉，需要30分钟完成作业
- **设置**：
  - 目标完成时间：22:30
  - 预估完成时间：30分钟
- **效果**：系统会显示"建议开始时间：22:00"
  - 提示：在22:00开始写作业，可以在22:30前完成

### 示例3：稍后提醒
- **场景**：提醒时间到了，但暂时不想写
- **操作**：点击"稍后提醒"
- **效果**：5分钟后会再次弹出提醒

## 技术实现

### 数据存储
- **本地存储**：提醒信息存储在本地，使用 `reminder_{homeworkId}` 作为key
- **云数据库**：提醒设置同步到云数据库 `homeworkReminders` 集合

### 提醒机制
- **定时检查**：应用启动时和每分钟检查一次提醒
- **时间判断**：检查当前时间是否到达提醒时间（允许5分钟误差）
- **弹窗提醒**：使用 `wx.showModal` 显示提醒弹窗

### 数据库结构

#### homeworkReminders 集合
```javascript
{
  _id: String,              // 自动生成的文档ID
  homeworkId: String,        // 作业ID
  homeworkTitle: String,     // 作业标题
  reminderTime: String,      // 提醒时间 HH:mm
  targetTime: String,        // 目标完成时间 HH:mm
  estimatedMinutes: Number,  // 预估完成时间（分钟）
  calculatedStartTime: String, // 计算出的开始时间 HH:mm
  isCompleted: Boolean,      // 是否已完成
  enabled: Boolean,          // 是否启用提醒
  createTime: Number,        // 创建时间戳
  updateTime: Number         // 更新时间戳
}
```

## 注意事项

1. **提醒权限**：需要用户授权通知权限（如果使用订阅消息）
2. **应用状态**：提醒功能在应用运行时有效，应用关闭后需要重新打开才能检查提醒
3. **时间精度**：提醒检查每分钟执行一次，可能存在1分钟误差
4. **本地存储**：提醒信息存储在本地，清除小程序数据会丢失提醒设置

## 未来优化

- [ ] 支持多个提醒时间（如：早上8点和晚上7点）
- [ ] 支持每周特定日期提醒（如：每周一、三、五）
- [ ] 使用微信订阅消息实现后台提醒
- [ ] 添加提醒历史记录
- [ ] 支持提醒音效和震动
- [ ] 添加作业完成统计功能

## 使用建议

1. **合理设置预估时间**：根据作业难度和数量，合理设置预估完成时间
2. **提前设置提醒**：建议在前一天晚上设置好第二天的提醒
3. **及时标记完成**：完成作业后及时标记，避免重复提醒
4. **灵活调整**：根据实际情况，可以随时调整提醒时间和预估时间

